---
title: "Laboratorio"
author: "Hugo"
date: "28 de Dezembro de 2019"
output:
  html_document:
    highlight: tango
    theme: united
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: no
      smooth_scroll: no
  pdf_document:
    toc: yes
    toc_depth: '3'
---


```{r}
library(here)
library(data.table)
library(countrycode)
library(ggplot2)
library(magrittr)
library(ggrepel)
library(knitr)
library(kableExtra)

dados <- fread(here("CancerMortalityEU.csv"), header = TRUE, check.names = TRUE)

# Colunas certas
names(dados)

dados$CancerSite <- as.factor(dados$CancerSite) ; dados$Country <- as.factor(dados$Country) ; dados$ageGroup <- as.factor(dados$ageGroup)

summary(dados$CancerSite)

cancro <- dados[CancerSite %in% "Liver and Intrahepatic Bile Ducts"]


str(cancro)
cancro[, .N, by="CancerSite"] #Pode-se tirar esta coluna
cancro[, .N, by="Cause"] #Pode-se tirar esta coluna mas a ver se não se perde a informação
cancro[, .N, by="ageStart"] #Acho que se pode tirar também
cancro[, .N, by="ageLabel"] #Também acho que se pode tirar se bem que esta pode ser util à frente
cancro[, c("CancerSite", "Cause", "ageStart", "ageLabel"):=NULL]

# Melt em que os dados de ambos os sexos ficam juntos
cancro.j <- melt(cancro,
            id.vars = c("Country","ageGroup"),
            variable.name = "Year")

#Soma dos cancros de raparigas em 2011 na Europa
sum(cancro.j[Year %in% levels(cancro.j$Year)[1]]$value, na.rm = TRUE)

#Melt em que os dados de ambos os sexos ficaram separados
cancro.s <- melt(cancro,
                 id.vars = c("Country","ageGroup"),
                 measure=patterns("^Female","^Males"),
                 variable.name = "Year",
                 value.name = c("Female","Male"))

levels(cancro.j$Year)[1]
```

































